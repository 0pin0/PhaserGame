{"code":"import { __extends } from \"tslib\";\r\nimport \"phaser\";\r\nvar VersionText = '2023/3/4 12:31';\r\nvar LSKey_TypeId = 'LSKey_TypeId';\r\nvar LSKey_GameId = 'LSKey_GameId';\r\nvar Demo = /** @class */ (function (_super) {\r\n    __extends(Demo, _super);\r\n    //#region base\r\n    function Demo() {\r\n        var _this = _super.call(this, \"Demo\") || this;\r\n        _this.btnImageKey = 'btn';\r\n        _this.menuBtnPosY = 60;\r\n        _this.gameTitlePosY = 120;\r\n        _this.gameName2 = '建立動畫事件';\r\n        _this.gameName3 = '縮放鏡頭';\r\n        _this.gameName4 = '數學曲線';\r\n        _this.typeId = 0;\r\n        _this.gameId = 0;\r\n        _this.gameIdTable = [\r\n            [],\r\n            [1],\r\n            [2],\r\n            [3],\r\n            [4],\r\n        ];\r\n        _this.typeNameList = [\r\n            'None',\r\n            'PhaserTS',\r\n            \"\\u52D5\\u756B\",\r\n            \"\\u93E1\\u982D\",\r\n            \"\\u6578\\u5B78\"\r\n        ];\r\n        _this.gameNameList = [\r\n            '上一層',\r\n            'PhaserTS',\r\n            \"\" + _this.gameName2,\r\n            \"\" + _this.gameName3,\r\n            \"\" + _this.gameName4\r\n        ];\r\n        _this.btnList = [];\r\n        //#endregion game2\r\n        //#region game3\r\n        //  Sphinx\r\n        _this.location1 = new Phaser.Math.Vector2(766, 1090);\r\n        //  Oasis\r\n        _this.location2 = new Phaser.Math.Vector2(225, 1552);\r\n        //  Tomb\r\n        _this.location3 = new Phaser.Math.Vector2(700, 1592);\r\n        //  City Gates\r\n        _this.location4 = new Phaser.Math.Vector2(323, 480);\r\n        //  Chair\r\n        _this.location5 = new Phaser.Math.Vector2(593, 274);\r\n        //  River Hormuz\r\n        _this.location6 = new Phaser.Math.Vector2(180, 1087);\r\n        //  Guard Outpost\r\n        _this.location7 = new Phaser.Math.Vector2(168, 163);\r\n        // 轉換GameId\r\n        var typeIdText = window.localStorage.getItem(LSKey_TypeId);\r\n        var gameIdText = window.localStorage.getItem(LSKey_GameId);\r\n        console.log(\"typeIdText=\" + typeIdText + \" GameIdText=\" + gameIdText);\r\n        _this.typeId = 0;\r\n        if (typeIdText) {\r\n            _this.typeId = +typeIdText;\r\n        }\r\n        else {\r\n            window.localStorage.setItem(LSKey_TypeId, \"0\");\r\n        }\r\n        _this.gameId = 0;\r\n        if (gameIdText) {\r\n            _this.gameId = +gameIdText;\r\n        }\r\n        else {\r\n            window.localStorage.setItem(LSKey_GameId, \"0\");\r\n        }\r\n        console.log(\"typeId=\" + _this.typeId + \" GameId=\" + _this.gameId);\r\n        return _this;\r\n    }\r\n    Demo.prototype.preload = function () {\r\n        console.log(\"preload\");\r\n        // 已選GAME時，切換game\r\n        if (this.typeId > 0) {\r\n            switch (this.gameId) {\r\n                case 0:\r\n                    break;\r\n                case 1:\r\n                    this.preload_Game1();\r\n                    break;\r\n                case 2:\r\n                    this.preload_Game2();\r\n                    break;\r\n                case 3:\r\n                    this.preload_Game3();\r\n                    break;\r\n                case 4:\r\n                    break;\r\n                default:\r\n                    console.error(\"undefined, GameId=\" + this.gameId);\r\n                    break;\r\n            }\r\n        }\r\n        this.preload_Menu();\r\n    };\r\n    Demo.prototype.create = function () {\r\n        console.log(\"create\");\r\n        // 已選GAME時，切換game\r\n        if (this.typeId > 0) {\r\n            console.log(\"GameId=\" + this.gameId);\r\n            switch (this.gameId) {\r\n                case 0:\r\n                    break;\r\n                case 1:\r\n                    this.create_Game1();\r\n                    break;\r\n                case 2:\r\n                    this.create_Game2();\r\n                    break;\r\n                case 3:\r\n                    this.create_Game3();\r\n                    break;\r\n                case 4:\r\n                    break;\r\n                default:\r\n                    console.error(\"undefined, GameId=\" + this.gameId);\r\n                    break;\r\n            }\r\n        }\r\n        this.create_Menu();\r\n    };\r\n    /** 目錄 */\r\n    Demo.prototype.preload_Menu = function () {\r\n        try {\r\n            this.load.image(this.btnImageKey, \"assets/button1_s.png\");\r\n        }\r\n        catch (e) {\r\n            console.error(\"msg=\" + e);\r\n        }\r\n    };\r\n    /** 目錄 */\r\n    Demo.prototype.create_Menu = function () {\r\n        var _this = this;\r\n        // 刪除舊btn\r\n        this.btnList.forEach(function (btn) {\r\n            btn.destroy();\r\n        });\r\n        this.btnList.length = 0;\r\n        this.add.text(0, 0, \"ver \" + VersionText + \"\\n\");\r\n        console.log(\"typeId=\" + this.typeId + \" gameId=\" + this.gameId);\r\n        // 目錄\r\n        this.add.text(10, 30, \"\\u9EDE\\u64CA\\u5207\\u63DB\\n t=\" + this.typeId + \" \\n g=\" + this.gameId);\r\n        // 若是未選擇type/GAME，就是顯示類型頁\r\n        if (this.typeId === 0 && this.gameId === 0) {\r\n            console.log(\"length=\" + this.gameIdTable.length);\r\n            for (var i = 1; i < this.gameIdTable.length; i++) {\r\n                var text = this.typeNameList[i];\r\n                this.addButton(i, text);\r\n            }\r\n        }\r\n        // 若是有選擇type，沒選game，就是顯示上一頁/全部game\r\n        else if (this.typeId > 0 && this.gameId === 0) {\r\n            var gameIDList = this.gameIdTable[this.typeId];\r\n            var endIdx = gameIDList.length;\r\n            if (endIdx < 0) {\r\n                console.error(\"endIdx=\" + endIdx);\r\n                return;\r\n            }\r\n            // 返回\r\n            this.addButton(0, this.gameNameList[0]);\r\n            // 分類的game按鈕\r\n            console.log(\"endIdx=\" + endIdx);\r\n            gameIDList.forEach(function (gameId, index) {\r\n                var text = _this.gameNameList[gameId];\r\n                _this.addButton(index + 1, text);\r\n            });\r\n            for (var i = 0; i <= endIdx; i++) {\r\n            }\r\n        }\r\n        // 若是有選擇game也有選擇type，就是上一頁\r\n        else if (this.typeId > 0 && this.gameId > 0) {\r\n            this.addButton(0, this.gameNameList[0]);\r\n        }\r\n        else {\r\n            console.error(\"unknown, typeId=\" + this.typeId + \" gameId=\" + this.gameId);\r\n        }\r\n    };\r\n    /** 加入按鈕\r\n     * @param i 索引\r\n     * @param text 文字\r\n     */\r\n    Demo.prototype.addButton = function (i, text) {\r\n        var _this = this;\r\n        var btn = this.add.image(120 + 80 * i, this.menuBtnPosY, this.btnImageKey);\r\n        btn.setScale(0.5);\r\n        btn.setInteractive();\r\n        btn.on('pointerup', function () { _this.onClickBtn(i); });\r\n        this.btnList.push(btn);\r\n        var btnText = this.add.text(btn.x, btn.y, text);\r\n        btnText.setOrigin(0.5, 0.5);\r\n    };\r\n    //#endregion base\r\n    //#region btn\r\n    Demo.prototype.onClickBtn = function (index) {\r\n        console.log(\"onClickBtn=\" + index + \" typeId=\" + this.typeId + \" gameId=\" + this.gameId);\r\n        // 若是未選擇type\r\n        if (this.typeId === 0) {\r\n            // 若是未選擇game，就設定type清除game，並顯示game目錄\r\n            if (this.typeId === 0 && this.gameId === 0) {\r\n                this.typeId = index;\r\n                window.localStorage.setItem(LSKey_TypeId, \"\" + this.typeId);\r\n                this.gameId = 0;\r\n                window.localStorage.setItem(LSKey_GameId, \"\" + this.gameId);\r\n                console.log(\"onClickBtn=\" + index + \" typeId=\" + this.typeId + \" gameId=\" + this.gameId);\r\n                // 重新載入網頁\r\n                location.reload();\r\n            }\r\n            else {\r\n                console.error(\"unknown, typeId=\" + this.typeId + \" gameId=\" + this.gameId);\r\n            }\r\n        }\r\n        // 若是有選擇type\r\n        else if (this.typeId > 0) {\r\n            // 若按返回鈕，就清除gameId\r\n            if (index === 0) {\r\n                this.typeId = 0;\r\n                window.localStorage.setItem(LSKey_TypeId, \"\" + this.typeId);\r\n                this.gameId = 0;\r\n                window.localStorage.setItem(LSKey_GameId, \"\" + this.gameId);\r\n                console.log(\"onClickBtn=\" + index + \" typeId=\" + this.typeId + \" gameId=\" + this.gameId);\r\n                // 重新載入網頁\r\n                location.reload();\r\n            }\r\n            // 若沒選game, 且按game鈕，就設定game\r\n            else if (this.gameId === 0 && index > 0) {\r\n                this.gameId = this.gameIdTable[this.typeId][index - 1];\r\n                window.localStorage.setItem(LSKey_GameId, \"\" + this.gameId);\r\n                console.log(\"onClickBtn=\" + index + \" typeId=\" + this.typeId + \" gameId=\" + this.gameId);\r\n                // 重新載入網頁\r\n                location.reload();\r\n            }\r\n            else {\r\n                console.error(\"unknown, typeId=\" + this.typeId + \" gameId=\" + this.gameId);\r\n            }\r\n        }\r\n        else {\r\n            console.error(\"unknown, typeId=\" + this.typeId + \" gameId=\" + this.gameId);\r\n        }\r\n    };\r\n    //#endregion btn\r\n    //#region game1\r\n    Demo.prototype.preload_Game1 = function () {\r\n        this.load.image(\"logo\", \"assets/phaser3-logo.png\");\r\n        this.load.image(\"libs\", \"assets/libs.png\");\r\n        this.load.glsl(\"bundle\", \"assets/plasma-bundle.glsl.js\");\r\n        this.load.glsl(\"stars\", \"assets/starfields.glsl.js\");\r\n    };\r\n    Demo.prototype.create_Game1 = function () {\r\n        console.log(\"Game1\");\r\n        this.add.shader(\"RGB Shift Field\", 0, 0, 800, 600).setOrigin(0);\r\n        this.add.shader(\"Plasma\", 0, 412, 800, 172).setOrigin(0);\r\n        this.add.image(400, 300, \"libs\");\r\n        var logo = this.add.image(400, 70, \"logo\");\r\n        this.tweens.add({\r\n            targets: logo,\r\n            y: 350,\r\n            duration: 1500,\r\n            ease: \"Sine.inOut\",\r\n            yoyo: true,\r\n            repeat: -1,\r\n        });\r\n        // version\r\n        this.add.text(0, this.gameTitlePosY, 'source code: Game1，phaser3 - logo.png, plasma - bundle.glsl.js, shader(RGB Shift Field, tweens.add');\r\n    };\r\n    Demo.prototype.preload_Game2 = function () {\r\n        // 載入atlas(png/json)\r\n        this.load.atlas('gems', 'assets/columns/gems.png', 'assets/columns/gems.json');\r\n        // Local variable\r\n        this.gemPosY = 160;\r\n    };\r\n    Demo.prototype.create_Game2 = function () {\r\n        // 提示字\r\n        this.add.text(400, 32, 'Click to create animations', { color: '#00ff00' })\r\n            .setOrigin(0.5, 0);\r\n        // 綁動畫建立event，建立時通知刷新\r\n        //  Each time a new animation is added to the Animation Manager we'll call this function\r\n        this.anims.on(Phaser.Animations.Events.ADD_ANIMATION, this.addAnimation, this);\r\n        this.gemIdx = 0;\r\n        // 點擊畫面，建立動畫\r\n        //  Click to add an animation\r\n        this.input.on('pointerup', function () {\r\n            switch (this.gemIdx) {\r\n                case 0:\r\n                    this.anims.create({ key: 'diamond', frames: this.anims.generateFrameNames('gems', { prefix: 'diamond_', end: 15, zeroPad: 4 }), repeat: -1 });\r\n                    break;\r\n                case 1:\r\n                    this.anims.create({ key: 'prism', frames: this.anims.generateFrameNames('gems', { prefix: 'prism_', end: 6, zeroPad: 4 }), repeat: -1 });\r\n                    break;\r\n                case 2:\r\n                    this.anims.create({ key: 'ruby', frames: this.anims.generateFrameNames('gems', { prefix: 'ruby_', end: 6, zeroPad: 4 }), repeat: -1 });\r\n                    break;\r\n                case 3:\r\n                    this.anims.create({ key: 'square', frames: this.anims.generateFrameNames('gems', { prefix: 'square_', end: 14, zeroPad: 4 }), repeat: -1 });\r\n                    break;\r\n            }\r\n            this.gemIdx++;\r\n        }, this);\r\n        // version\r\n        this.add.text(0, this.gameTitlePosY, this.gameName2 + \", gems.png, gems.json, anims.create, generateFrameNames\");\r\n    };\r\n    /** 建立動畫子元件 */\r\n    Demo.prototype.addAnimation = function (key) {\r\n        this.add.sprite(400, this.gemPosY, 'gems')\r\n            .play(key);\r\n        this.gemPosY += 100;\r\n    };\r\n    Demo.prototype.preload_Game3 = function () {\r\n        this.load.image('map', 'assets/camera/earthbound-scarab.png');\r\n    };\r\n    Demo.prototype.create_Game3 = function () {\r\n        this.cameras.main.setBounds(0, 0, 1024, 2048);\r\n        this.add.image(0, 0, 'map').setOrigin(0);\r\n        this.cameras.main.setZoom(1);\r\n        this.cameras.main.centerOn(0, 0);\r\n        var pos = 1;\r\n        this.input.on('pointerdown', function () {\r\n            var cam = this.cameras.main;\r\n            var location = this['location' + pos];\r\n            var rndZoom = Phaser.Math.FloatBetween(0.5, 4);\r\n            cam.pan(location.x, location.y, 3000, 'Sine.easeInOut');\r\n            cam.zoomTo(rndZoom, 3000);\r\n            pos++;\r\n            if (pos === 8) {\r\n                pos = 1;\r\n            }\r\n        }, this);\r\n        this.scene.launch('UIScene');\r\n    };\r\n    return Demo;\r\n}(Phaser.Scene));\r\nexport default Demo;\r\n//#region game3\r\nvar UIScene = /** @class */ (function (_super) {\r\n    __extends(UIScene, _super);\r\n    function UIScene() {\r\n        return _super.call(this, 'UIScene') || this;\r\n    }\r\n    UIScene.prototype.create = function () {\r\n        this.mapScene = this.scene.get('Demo');\r\n        this.mapCamera = this.mapScene.cameras.main;\r\n        this.graphics = this.add.graphics();\r\n        this.tooltip1 = this.add.text(0, 0, 'Sphinx');\r\n        this.tooltip2 = this.add.text(0, 0, 'Oasis');\r\n        this.tooltip3 = this.add.text(0, 0, 'Tomb of Ket');\r\n        this.tooltip4 = this.add.text(0, 0, 'City Gates');\r\n        this.tooltip5 = this.add.text(0, 0, 'Rest Easy');\r\n        this.tooltip6 = this.add.text(0, 0, 'River Hormuz');\r\n        this.tooltip7 = this.add.text(0, 0, 'Guard Outpost');\r\n    };\r\n    UIScene.prototype.update = function () {\r\n        this.graphics.clear();\r\n        this.updateToolTip(this.mapScene.location1, this.tooltip1);\r\n        this.updateToolTip(this.mapScene.location2, this.tooltip2);\r\n        this.updateToolTip(this.mapScene.location3, this.tooltip3);\r\n        this.updateToolTip(this.mapScene.location4, this.tooltip4);\r\n        this.updateToolTip(this.mapScene.location5, this.tooltip5);\r\n        this.updateToolTip(this.mapScene.location6, this.tooltip6);\r\n        this.updateToolTip(this.mapScene.location7, this.tooltip7);\r\n    };\r\n    UIScene.prototype.updateToolTip = function (source, tooltip) {\r\n        var basePosition = source;\r\n        var camera = this.mapCamera;\r\n        //  The marker point\r\n        var x = (basePosition.x - camera.worldView.x) * camera.zoom;\r\n        var y = (basePosition.y - camera.worldView.y) * camera.zoom;\r\n        var graphics = this.graphics;\r\n        graphics.fillStyle(0x000000, 0.8);\r\n        graphics.lineStyle(4, 0x000000, 0.8);\r\n        //  The text is above this point\r\n        var width = tooltip.width + 32;\r\n        var height = tooltip.height + 32;\r\n        var bx = x - width / 2;\r\n        var by = y - (height + 32);\r\n        graphics.fillRect(bx, by, width, height);\r\n        tooltip.x = bx + 16;\r\n        tooltip.y = by + 16;\r\n        graphics.lineBetween(bx + 16, by + height, x, y);\r\n    };\r\n    return UIScene;\r\n}(Phaser.Scene));\r\n//#endregion game3\r\n//#region game4\r\n// dwitter globals\r\nvar c;\r\nvar x;\r\nvar math_I;\r\nvar q;\r\nvar tin = 0;\r\nvar frame = 0;\r\nvar S = Math.sin;\r\nvar C = Math.cos;\r\nvar T = Math.tan;\r\nfunction R(r, g, b, a) {\r\n    a = a === undefined ? 1 : a;\r\n    return \"rgba(\" + (r | 0) + \",\" + (g | 0) + \",\" + (b | 0) + \",\" + a + \")\";\r\n}\r\n;\r\n// https://www.dwitter.net/d/5446\r\nfunction u(t) {\r\n    c.width |= math_I = 300;\r\n    x.lineWidth = .1;\r\n    while (--math_I)\r\n        q = 19 + S(t / 6) / 28 * math_I, x.arc(S(q / 3) * math_I + q * 60, (C(q * S(t / 2)) + 4) * math_I / 2 + 200, (C(q) * 60 + 200) * S(math_I / 96), 0, 7);\r\n    x.stroke();\r\n}\r\nfunction create() {\r\n    var canvasTexture = this.textures.createCanvas('dwitter', 1920, 1080);\r\n    c = canvasTexture.getSourceImage();\r\n    x = c.getContext('2d');\r\n    this.add.image(0, 0, 'dwitter').setOrigin(0).setScale(0.5);\r\n}\r\nfunction update() {\r\n    tin = frame / 60;\r\n    if ((tin * 60 | 0) == frame - 1) {\r\n        tin += 0.000001;\r\n    }\r\n    frame++;\r\n    u(tin);\r\n}\r\n//#endregion game4\r\nvar config;\r\nvar checkGameId = +window.localStorage.getItem(LSKey_GameId);\r\nconsole.log(\"checkGameId=\" + checkGameId);\r\nswitch (checkGameId) {\r\n    case 3:\r\n        config = {\r\n            type: Phaser.AUTO,\r\n            backgroundColor: \"#125555\",\r\n            width: 800,\r\n            height: 600,\r\n            scene: [Demo, UIScene]\r\n        };\r\n        break;\r\n    case 4:\r\n        config = {\r\n            type: Phaser.CANVAS,\r\n            backgroundColor: \"#125555\",\r\n            width: 800,\r\n            height: 600,\r\n            scene: {\r\n                create: create,\r\n                update: update\r\n            }\r\n        };\r\n        window.localStorage.setItem(LSKey_TypeId, '0');\r\n        window.localStorage.setItem(LSKey_GameId, '0');\r\n        break;\r\n    default:\r\n        config = {\r\n            type: Phaser.AUTO,\r\n            backgroundColor: \"#125555\",\r\n            width: 800,\r\n            height: 600,\r\n            scene: [Demo],\r\n        };\r\n        break;\r\n}\r\nvar game = new Phaser.Game(config);\r\n","references":["D:/PhaserProj/PhaserGame1/node_modules/phaser/types/phaser.d.ts","D:/PhaserProj/PhaserGame1/dist/global.js"]}
