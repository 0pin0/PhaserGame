{"code":"import { __extends } from \"tslib\";\r\nimport \"phaser\";\r\nvar VersionText = '2023/3/3 07:29';\r\nvar LSKey_GameId = 'LSKey_GameID';\r\nvar Demo = /** @class */ (function (_super) {\r\n    __extends(Demo, _super);\r\n    //#region base\r\n    function Demo() {\r\n        var _this = _super.call(this, \"Demo\") || this;\r\n        _this.btnImageKey = 'btn';\r\n        _this.menuBtnPosY = 60;\r\n        _this.gameTitlePosY = 120;\r\n        _this.maxGameId = 3;\r\n        _this.gameId = 0;\r\n        _this.gameName2 = '建立動畫事件';\r\n        _this.gameName3 = '縮放鏡頭';\r\n        _this.gameNameList = [\r\n            '目錄',\r\n            'PhaserTS',\r\n            \"\" + _this.gameName2,\r\n            \"\" + _this.gameName3\r\n        ];\r\n        //#endregion game2\r\n        //#region game3\r\n        //  Sphinx\r\n        _this.location1 = new Phaser.Math.Vector2(766, 1090);\r\n        //  Oasis\r\n        _this.location2 = new Phaser.Math.Vector2(225, 1552);\r\n        //  Tomb\r\n        _this.location3 = new Phaser.Math.Vector2(700, 1592);\r\n        //  City Gates\r\n        _this.location4 = new Phaser.Math.Vector2(323, 480);\r\n        //  Chair\r\n        _this.location5 = new Phaser.Math.Vector2(593, 274);\r\n        //  River Hormuz\r\n        _this.location6 = new Phaser.Math.Vector2(180, 1087);\r\n        //  Guard Outpost\r\n        _this.location7 = new Phaser.Math.Vector2(168, 163);\r\n        // 轉換gameId\r\n        var gameIdText = window.localStorage.getItem(LSKey_GameId);\r\n        _this.gameId = 1;\r\n        if (gameIdText) {\r\n            _this.gameId = +gameIdText;\r\n        }\r\n        console.log(\"gameId=\" + _this.gameId);\r\n        return _this;\r\n    }\r\n    Demo.prototype.preload = function () {\r\n        console.log(\"preload\");\r\n        // 切換game\r\n        switch (this.gameId) {\r\n            case 1:\r\n                this.preload_Game1();\r\n                break;\r\n            case 2:\r\n                this.preload_Game2();\r\n                break;\r\n            case 3:\r\n                this.preload_Game3();\r\n                break;\r\n            default:\r\n                console.error(\"undefined, gameId=\" + this.gameId);\r\n                break;\r\n        }\r\n        this.preload_Game0();\r\n    };\r\n    Demo.prototype.create = function () {\r\n        console.log(\"create\");\r\n        // 切換game\r\n        console.log(\"gameId=\" + this.gameId);\r\n        switch (this.gameId) {\r\n            case 1:\r\n                this.create_Game1();\r\n                break;\r\n            case 2:\r\n                this.create_Game2();\r\n                break;\r\n            case 3:\r\n                this.create_Game3();\r\n                break;\r\n            default:\r\n                console.error(\"undefined, gameId=\" + this.gameId);\r\n                break;\r\n        }\r\n        this.create_Game0();\r\n    };\r\n    Demo.prototype.preload_Game0 = function () {\r\n        // 目錄\r\n        try {\r\n            this.load.image(this.btnImageKey, \"assets/button1_s.png\");\r\n        }\r\n        catch (e) {\r\n            console.error(\"msg=\" + e);\r\n        }\r\n    };\r\n    Demo.prototype.create_Game0 = function () {\r\n        var _this = this;\r\n        this.add.text(0, 0, \"ver \" + VersionText + \"\\n\");\r\n        // 目錄\r\n        this.add.text(10, 30, \"\\u9EDE\\u64CA\\u5207\\u63DB\");\r\n        // 目錄會顯示全部game，非目錄的只show目綠鈕\r\n        var maxId = this.gameId > 0 ? 0 : this.maxGameId;\r\n        var _loop_1 = function (i) {\r\n            var btn = this_1.add.image(120 + 80 * i, this_1.menuBtnPosY, this_1.btnImageKey);\r\n            btn.setScale(0.5);\r\n            btn.setInteractive();\r\n            btn.on('pointerdown', function () { _this.onClickBtn(i); });\r\n            var text = this_1.gameNameList[i];\r\n            var btnText = this_1.add.text(btn.x, btn.y, text);\r\n            btnText.setOrigin(0.5, 0.5);\r\n        };\r\n        var this_1 = this;\r\n        for (var i = 0; i <= maxId; i++) {\r\n            _loop_1(i);\r\n        }\r\n    };\r\n    //#endregion base\r\n    //#region btn\r\n    Demo.prototype.onClickBtn = function (index) {\r\n        console.log(\"onClickBtn\" + index);\r\n        window.localStorage.setItem(LSKey_GameId, \"\" + index);\r\n        location.reload();\r\n    };\r\n    //#endregion btn\r\n    //#region game1\r\n    Demo.prototype.preload_Game1 = function () {\r\n        this.load.image(\"logo\", \"assets/phaser3-logo.png\");\r\n        this.load.image(\"libs\", \"assets/libs.png\");\r\n        this.load.glsl(\"bundle\", \"assets/plasma-bundle.glsl.js\");\r\n        this.load.glsl(\"stars\", \"assets/starfields.glsl.js\");\r\n    };\r\n    Demo.prototype.create_Game1 = function () {\r\n        console.log(\"Game1\");\r\n        this.add.shader(\"RGB Shift Field\", 0, 0, 800, 600).setOrigin(0);\r\n        this.add.shader(\"Plasma\", 0, 412, 800, 172).setOrigin(0);\r\n        this.add.image(400, 300, \"libs\");\r\n        var logo = this.add.image(400, 70, \"logo\");\r\n        this.tweens.add({\r\n            targets: logo,\r\n            y: 350,\r\n            duration: 1500,\r\n            ease: \"Sine.inOut\",\r\n            yoyo: true,\r\n            repeat: -1,\r\n        });\r\n        // version\r\n        this.add.text(0, this.gameTitlePosY, 'source code: Game1，phaser3 - logo.png, plasma - bundle.glsl.js, shader(RGB Shift Field, tweens.add');\r\n    };\r\n    Demo.prototype.preload_Game2 = function () {\r\n        // 載入atlas(png/json)\r\n        this.load.atlas('gems', 'assets/columns/gems.png', 'assets/columns/gems.json');\r\n        // Local variable\r\n        this.gemPosY = 160;\r\n    };\r\n    Demo.prototype.create_Game2 = function () {\r\n        // 提示字\r\n        this.add.text(400, 32, 'Click to create animations', { color: '#00ff00' })\r\n            .setOrigin(0.5, 0);\r\n        // 綁動畫建立event，建立時通知刷新\r\n        //  Each time a new animation is added to the Animation Manager we'll call this function\r\n        this.anims.on(Phaser.Animations.Events.ADD_ANIMATION, this.addAnimation, this);\r\n        this.gemIdx = 0;\r\n        // 點擊畫面，建立動畫\r\n        //  Click to add an animation\r\n        this.input.on('pointerup', function () {\r\n            switch (this.gemIdx) {\r\n                case 0:\r\n                    this.anims.create({ key: 'diamond', frames: this.anims.generateFrameNames('gems', { prefix: 'diamond_', end: 15, zeroPad: 4 }), repeat: -1 });\r\n                    break;\r\n                case 1:\r\n                    this.anims.create({ key: 'prism', frames: this.anims.generateFrameNames('gems', { prefix: 'prism_', end: 6, zeroPad: 4 }), repeat: -1 });\r\n                    break;\r\n                case 2:\r\n                    this.anims.create({ key: 'ruby', frames: this.anims.generateFrameNames('gems', { prefix: 'ruby_', end: 6, zeroPad: 4 }), repeat: -1 });\r\n                    break;\r\n                case 3:\r\n                    this.anims.create({ key: 'square', frames: this.anims.generateFrameNames('gems', { prefix: 'square_', end: 14, zeroPad: 4 }), repeat: -1 });\r\n                    break;\r\n            }\r\n            this.gemIdx++;\r\n        }, this);\r\n        // version\r\n        this.add.text(0, this.gameTitlePosY, this.gameName2 + \", gems.png, gems.json, anims.create, generateFrameNames\");\r\n    };\r\n    /** 建立動畫子元件 */\r\n    Demo.prototype.addAnimation = function (key) {\r\n        this.add.sprite(400, this.gemPosY, 'gems')\r\n            .play(key);\r\n        this.gemPosY += 100;\r\n    };\r\n    Demo.prototype.preload_Game3 = function () {\r\n        this.load.image('map', 'assets/camera/earthbound-scarab.png');\r\n    };\r\n    Demo.prototype.create_Game3 = function () {\r\n        this.cameras.main.setBounds(0, 0, 1024, 2048);\r\n        this.add.image(0, 0, 'map').setOrigin(0);\r\n        this.cameras.main.setZoom(1);\r\n        this.cameras.main.centerOn(0, 0);\r\n        var pos = 1;\r\n        this.input.on('pointerdown', function () {\r\n            var cam = this.cameras.main;\r\n            var location = this['location' + pos];\r\n            var rndZoom = Phaser.Math.FloatBetween(0.5, 4);\r\n            cam.pan(location.x, location.y, 3000, 'Sine.easeInOut');\r\n            cam.zoomTo(rndZoom, 3000);\r\n            pos++;\r\n            if (pos === 8) {\r\n                pos = 1;\r\n            }\r\n        }, this);\r\n        this.scene.launch('UIScene');\r\n    };\r\n    return Demo;\r\n}(Phaser.Scene));\r\nexport default Demo;\r\n//#region game3\r\nvar UIScene = /** @class */ (function (_super) {\r\n    __extends(UIScene, _super);\r\n    function UIScene() {\r\n        return _super.call(this, 'UIScene') || this;\r\n    }\r\n    UIScene.prototype.create = function () {\r\n        this.mapScene = this.scene.get('Demo');\r\n        this.mapCamera = this.mapScene.cameras.main;\r\n        this.graphics = this.add.graphics();\r\n        this.tooltip1 = this.add.text(0, 0, 'Sphinx');\r\n        this.tooltip2 = this.add.text(0, 0, 'Oasis');\r\n        this.tooltip3 = this.add.text(0, 0, 'Tomb of Ket');\r\n        this.tooltip4 = this.add.text(0, 0, 'City Gates');\r\n        this.tooltip5 = this.add.text(0, 0, 'Rest Easy');\r\n        this.tooltip6 = this.add.text(0, 0, 'River Hormuz');\r\n        this.tooltip7 = this.add.text(0, 0, 'Guard Outpost');\r\n    };\r\n    UIScene.prototype.update = function () {\r\n        this.graphics.clear();\r\n        this.updateToolTip(this.mapScene.location1, this.tooltip1);\r\n        this.updateToolTip(this.mapScene.location2, this.tooltip2);\r\n        this.updateToolTip(this.mapScene.location3, this.tooltip3);\r\n        this.updateToolTip(this.mapScene.location4, this.tooltip4);\r\n        this.updateToolTip(this.mapScene.location5, this.tooltip5);\r\n        this.updateToolTip(this.mapScene.location6, this.tooltip6);\r\n        this.updateToolTip(this.mapScene.location7, this.tooltip7);\r\n    };\r\n    UIScene.prototype.updateToolTip = function (source, tooltip) {\r\n        var basePosition = source;\r\n        var camera = this.mapCamera;\r\n        //  The marker point\r\n        var x = (basePosition.x - camera.worldView.x) * camera.zoom;\r\n        var y = (basePosition.y - camera.worldView.y) * camera.zoom;\r\n        var graphics = this.graphics;\r\n        graphics.fillStyle(0x000000, 0.8);\r\n        graphics.lineStyle(4, 0x000000, 0.8);\r\n        //  The text is above this point\r\n        var width = tooltip.width + 32;\r\n        var height = tooltip.height + 32;\r\n        var bx = x - width / 2;\r\n        var by = y - (height + 32);\r\n        graphics.fillRect(bx, by, width, height);\r\n        tooltip.x = bx + 16;\r\n        tooltip.y = by + 16;\r\n        graphics.lineBetween(bx + 16, by + height, x, y);\r\n    };\r\n    return UIScene;\r\n}(Phaser.Scene));\r\n//#endregion game3\r\nvar config = {\r\n    type: Phaser.AUTO,\r\n    backgroundColor: \"#125555\",\r\n    width: 800,\r\n    height: 600,\r\n    scene: [],\r\n};\r\nvar gameId = +window.localStorage.getItem(LSKey_GameId);\r\nswitch (gameId) {\r\n    case 3:\r\n        config.scene = [Demo, UIScene];\r\n        break;\r\n    default:\r\n        config.scene = [Demo];\r\n        break;\r\n}\r\nvar game = new Phaser.Game(config);\r\n","references":["D:/PhaserProj/PhaserGame1/node_modules/phaser/types/phaser.d.ts","D:/PhaserProj/PhaserGame1/dist/global.js"]}
